language: node_js
node_js:
  - '8'
dist: trusty
services:
  - mongodb
  - redis-server
env:
  matrix:
    - NODE_ENV=ci PORT=3000
  global:
    - secure: M3M/HceKLEVllnLIncyjy9qYtJcoJv2UTh7xthdYLyJ6Z8fgIkXk2ZgEnbsGAd14blPbFgY/n83PYR36CeY3fbh+v18Cr7mDSBXORaugQ/1VGBRkw+7KwCNGp66M9/EFyv+0wqtKKf0rpIqRIQOzM8Fqp/5IeOTHItVa9XNVYC+CYyp6Ke3XAF3BlSb4QTM4YkcaLhRd2LsElCVJ0pO/EfZH8zBXHq+GoN1/i8IViuh+HkDCCOVEbCg+EH9grkDCNTYwR1fJxTslMXPtF8QJWABi6ojKVOaNzPs9u95F6yTpGauO4dfP8ZIc7jpgCtMOvVCc11Xt2e7IFBe9nxkHiWY1IA9eI9q8intLg7LQvNkHSPKGezjRL+DjwajDLE5p0q9nG1uAs1Iyfhl1oYGoqX8NQHZYQL/iMUhAGPOIVdCUWvKQ+DCj6ggY6kdv2rk00vZ3v1mDUT0HlltZFYNbuV3Qn/n9OIv52OJFQ/2OCjrL52DS22WO17Kz49yF2iiWFo40yIGhQFZMD///+Cq8qKOFRHWZ/iuY/+2xBY/KyDITOMUFpZqUJxV0YLtgJeLk+9bfPNo6nPjvNr/Ib9XNxlBiC13yyx5yvMS0uU3F2VLRsAi2om3tEO0Q8SJSlAznq8k7K/EH/Ugu4Bp76zsdqgDthO5zP8TTug8MAg2jXIY=
    - secure: FeYFhJPggfALJk8kOoTkJDqbWGgY/ZBGZW/WaA9CGiGxCbzsJHD/voGt29Bt40UlA+RFhGNKW5F2lOUOu2nhq3t8iQmScFq0mb4QHZvlcsaCuNiOc2/32UwK95uA34MKH91DljNAcrN3CtNRo8Ns8Pc6R698JBfZ23A7v4HPS2p/7+/xuEauu/khYd+fMeP7qEOLXrHPnSY/So8YYrqN9A0X85xdDHo9l9NUkhhHt+D3ELHIP0H83trJQKTok0NXdgd18zguHDwVDGa9FRJjbLDFy+z9BGbljcAWDhSeXnip6mpExnPfTOjy7+sEMhoIxratp/FIFfSl1QjimYixutCXvmeVU2S+uyNQqSt3GvMKLHNvSIGmzg+aCq3eNxO/RDDYpqemDQ3WW8JaxEWRW7CRs7COQECH/k6QJznw262OwEZmgLbmP3YiHjdNQhdgERegmqUiwMpVJz6eQBkMAoIwFB3VcLo1zRE0kcWzdRDXNebeE8VKrhnR4Mh139J0Rlkr8xhW9iijnfNLpUUTka90gKRUQomsNt0piXlnH4wWdjbVXRuuWizFZhN5QV52Vd31qpdpED65o7bYAI7VgEf3F2xDMpUXhV3X2JDCx7LPRFJUXHALD5Mh7egxBFIrgS3dAV/+trB/GGfWMj/hpB/3fY0dGUyb/NiEu+xD5TA=
    - secure: z5hKXzcZS/qh3GuPNuDhE0EpFjlVL6cHt08OcS+TkVZUJOJloIrXPXKrauiAHXBO56T1ZWfPpHGePbUqFqO2Oqdd4+9DTwu5Q6rmkbXyq+ezt1IkTPIxCGC2BcLWUxDs4hBkX20UuFdR5zN+uefDVGAMZTiDZqJQbTJqfkLlqA+A3AO4wWIM0wwSmRUARjVVuuAFRPmCFLLD8m+9NCKZWrG0YoclRLDXYJqPH7KZ9cf2YIMC3+bFQOLVR9DfEO76gRXeaWrJMwjL7IZBFq/AH7j4rG4SoQ+o9WagnBRZQ85BCt00Q3Ya1G3yIH7AeRBp5TwqKxQp/cpqlVOAme4BN40GuVfLkloGxyS3bhScYm/orbj5Nr2Q0mPgz9iMSdadYhBvhSzyyJvGw4NKIOrBbCQK59eU/2Ang9IklbEMCNEIp/oSTMF8rcfwxTNt74hlc3IxnlWAT6bQJ8+fNa/OkHJyhEvc7gDlvsCP0gsctbjNnjxDVdaodWv6546W3I4ZFgv/Ddh0n9GurdG4TVtq3h1Hp7OJ/mRJIzsyBPwEyN/VpLbnFpBWVM+T2CzwuryJiA0nnnMFCiDOF3fvGl6pXvT7tQX2Vb6ZBwThIe+ylRckPRlRHMfx7+PSaKv2g8McTTkGzF+5gGKSq1mrbP+ikkkh06WAZ/1hDVE47YfAAAk=
    - secure: lJIpIxpacQDgRw05ayjMyTyztuLLuLMBBway58GbWVCa0Nm7SukkTKI34emtv3+GyOv8dYJiyOi1SkvIc0sSpkv5dy6be5/DJCf+LKF5bzVO1d2WLl+PP7kWwLin7ULjaBFJovSbnjUtl7WN/z94M+hegNH37roUe3TdBuit74hIexjLX/Mt/ULHpBvFvGd/uWPwUsxVa5ACAaretZb/U1TJSGxcHsPLeZMz+SDNB695ZeT5XdNcqxupNNHceyp1PsQ6g4Lyzfx8Zesgbn729cLzEh9nUhzU36QGc42hA2RJLZM+GS2XL0fZ0rPJNZQA5xEl2TOUou/EghdA+UAtji1wITtw4Y9DhX1Yh9KaLtPFEeUiHxzF7UcIznRK3/I0FlmVP2NSrqHtmmVLfYASJbK117NJYgp1BJkIkAuEogCAlQsPE0x4yjp9qIG28OHC3urMAERIxq/uJA6onK1A1NA3b+RU82eZUo564MblWXUw4Opas0pU+0DOMH3cq3lu97qBahb6jDUqZUU7x8ba6myFsBoC4huXto04AcGy0LW53MQT/8p78VyJ3IS5MjmzQPPs8QYVJQO5mUUqnu5l/T2Adq8tkiue7PlL//LKcVZym1t44KQcdQWnOlMEry52I+gaHtR6tIk3/9a/n+pFHiE0WFpK7ajcuNANqFjP4Ak=
    - secure: WNy+FuJMB8j4OqBa3oP9aRV4AYDr8kfJV+2Zdt2yLEbpbywDuIUQtqHjKlWWWL0xMivRpxcW23JzlVHBFIQH5RQvjrdrdW1sj8SdmX9pcgdKgG3mfo2sNbF1L9UYPgpYJJU0JsvRqEr2P6fdxNZDntvputt1VVN3VWjmdJQkYv2gAkF9onU+A8aNPa50vor5ozIcFkA8ou2iW8mOOc8sdimwue2MikcPHnjhJiBHz6uBOMtPIshkC/rBbZGba0AnMxf8dvfYrbAPApmlxZ7mLBWmXw9r4TaJNWC0jFeRIOQUpClUQQqhZ8mVcubdtGa2WWMZG5/wit2XJqeeEYttqodIw7wQArB8zfi5vrPllkRBiCqZP9jpQ/Ix5D4X7ErKqXHwiS9f/N7Q/9hzhXs6E2IXlfSsmw2OGcgn9VwCMsjJfGO2R+PPgSR+n/tltGSr3ttJCuVnLpxDaefVFsnG4sltwyZG2AzDK2HT7MNAbNWg5hbsgv56eXjaRVDyc+aPvYcTA6m6k/jmlRV+NXi2m4hcudurM7H5bafkbW71yP0agfNv1si65Q3C70KodUK9PpBL9Sktj0DDhzo/xOsWmUso9HKguUjOgFnwwxGgN7mzbZEQ66N++rBZEMdFaxyL+04yFrggM+GJiVLZoM7WBPNZAWQb0HN1tBFvbC08KFY=
cache:
  directories:
    - node_modules
    - client/node_modules
install:
  - npm install --no-optional
  - npm run build
script:
  - nohup npm run start &
  - sleep 3
  - npm run test
